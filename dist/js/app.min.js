(()=>{"use strict";const e=window.Telegram.WebApp;let t=document.querySelector(".close__app");e.ready(t.style.display="block"),e.expand(),t.addEventListener("click",(t=>{e.close()}));let n=document.querySelector(".hi__wrapper"),a=localStorage.getItem("data");document.querySelector(".hi__close"),n.style.display=null===a?"block":"none",localStorage.setItem("data",1);const l=document.querySelector("canvas"),o=document.querySelector(".wrapper__touch"),s=l.getContext("2d");let c="#000000",i="#000000",r=1,d=null,u=null;function y(){l.width=window.innerWidth,l.height=window.innerHeight}function m(e){let t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}function p(e){let t=document.querySelector(".canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}function g(e,t,n=`${c}`){s.fillStyle=n,s.strokeStyle=n,s.beginPath(),s.arc(e,t,""+q/2,0,2*Math.PI),s.fill()}y(),o.append(m(l)),window.addEventListener("resize",y),document.querySelector(".color__box").addEventListener("change",(function(e){e.preventDefault();let t=document.querySelector(".color__choose");c=t.value,i=t.value})),o.addEventListener("touchstart",(function(e){if(e.target.classList.contains("canvas")||e.target.classList.contains("number__box")){if(r>=1){let e=document.querySelectorAll("canvas");for(let t=r+1;t<e.length;t++)e[t].remove()}!function(e){d={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY},u={x:d.x,y:d.y},g(d.x,d.y,`${c}`),s.beginPath(),s.moveTo(d.x,d.y)}(e)}})),o.addEventListener("touchmove",(function(e){(e.target.classList.contains("canvas")||e.target.classList.contains("number__box"))&&function(e){u={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY},s.lineTo(u.x,u.y),s.lineWidth=q,s.strokeStyle=c,s.lineCap="round",s.lineJoin="bevel",s.stroke()}(e)})),o.addEventListener("touchend",(function(e){(e.target.classList.contains("canvas")||e.target.classList.contains("number__box"))&&(function(e){r++,X.style.display=r>0?"block":"none",u={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}(e),o.append(m(l)))}));let _={x:0,y:0},f=!1;l.addEventListener("mousedown",(function(e){0===e.button&&(_.x=e.pageX-this.offsetLeft,_.y=e.pageY-this.offsetTop,f=!0,g(_.x,_.y,`${c}`),s.beginPath(),s.moveTo(_.x,_.y))})),l.addEventListener("mousemove",(function(e){if(0===e.button&&1==f){if(r>=1){let e=document.querySelectorAll("canvas");for(let t=r+1;t<e.length;t++)e[t].remove()}_.x=e.pageX-this.offsetLeft,_.y=e.pageY-this.offsetTop,s.lineTo(_.x,_.y),s.lineWidth=q,s.strokeStyle=c,s.lineCap="round",s.lineJoin="bevel",s.stroke()}})),l.addEventListener("mouseup",(function(e){0===e.button&&(_.x=e.pageX-this.offsetLeft,_.y=e.pageY-this.offsetTop,s.lineTo(_.x,_.y),s.stroke(),s.closePath(),f=!1,o.append(m(l)),r++,X.style.display=r>0?"block":"none")}));let h,v=document.querySelectorAll(".tool__item"),b=document.querySelectorAll(".btn__audio"),L=0;function x(){h=navigator.onLine?1:0}window.addEventListener("online",x),window.addEventListener("offline",x),x(),o.addEventListener("click",(function(e){e.target.classList.contains("hi__wrapper")||e.target.classList.contains("hi__text")||e.target.classList.contains("hi__name")||(n.style.display="none");let t=document.querySelector(".number__box"),a=document.querySelector(".number__choose"),d=document.querySelector(".number__choose-close"),u=document.querySelector(".range__wrapper"),y=document.querySelector(".range__close"),p=document.querySelector(".btn__play"),g=parseInt(e.target.dataset.number),_=document.querySelector(".menu__wrapper"),f=document.querySelector(".reset__confirmation"),S=document.querySelector(".menu__box"),q=document.querySelector(".pay__box"),k=document.querySelector(".picture__wrapper"),w=document.getElementById("picCurrent"),E=document.querySelector(".pic__current"),T=document.getElementById("imgCurrent"),$=document.querySelector(".img__current");function A(){k.style.display="none",t.style.display="none"}function I(){t.style.display="none",a.style.display="none",p.classList.remove("active")}function M(){v[g].classList.remove("active"),v[1].classList.add("active")}if(e.target.classList.contains("btn__audio")&&(L=parseInt(e.target.dataset.sound),b.forEach((e=>e.classList.remove("active"))),b[L].classList.add("active")),e.target.classList.contains("tool__click")&&(v.forEach((e=>e.classList.remove("active"))),u.style.display="none",e.target.classList.add("active"),a.style.display="none",c=0===g?"#ffffff":i),e.target.classList.contains("width__box")&&(u.style.display="block",v[g].classList.add("active"),y.onclick=function(){u.style.display="none",M()}),e.target.classList.contains("reset__box")&&(_.style.display="flex",f.style.display="block",_.addEventListener("click",(function(e){if(e.target.classList.contains("yes")&&(s.clearRect(0,0,l.width,l.height),C.style.display="none",X.style.display="none",_.style.display="none",f.style.display="none",k.style.display="none",E.style.display="none",$.style.display="none",M(),I(),document.querySelector("#imgCurrent").src="",r>1)){let e=document.querySelectorAll("canvas");for(let t=1;t<e.length;t++)e[t].remove();o.append(m(l)),r=1}e.target.classList.contains("no")&&(_.style.display="none",f.style.display="none",M())}))),e.target.classList.contains("number__btn")){function D(e){var t=new Audio;t.src=e,t.autoplay=!0}a.style.display="grid",d.onclick=function(){a.style.display="none",M()},a.addEventListener("click",(function(e){let n=e.target.dataset.point;if(e.target.classList.contains("number__choose-item")){if(x(),s.clearRect(0,0,l.width,l.height),t.style.display="flex",t.innerText="",k.style.display="none",0===h){let e=localStorage.getItem(`imgData${n}`);$.style.display="block",E.style.display="none",A(),T.innerText="",T.src="data:image/gif;base64,"+e,p.classList.remove("active")}else{t.insertAdjacentHTML("afterbegin",`<img src="img/number/number${n}.gif?rand${Math.random()}" alt="number" />`),p.classList.add("active");let e=`./files/audio/audio${n}.mp3`;0===L&&D(e),p.onclick=function(){t.innerText="",t.insertAdjacentHTML("afterbegin",`<img src="img/number/number${n}.gif?rand${Math.random()}" alt="number" />`),0===L&&D(e)}}if(C.style.display="none",X.style.display="none",r>1){let e=document.querySelectorAll("canvas");for(let t=1;t<e.length;t++)e[t].remove();o.append(m(l)),r=1}a.style.display="none",M(),c=i}e.target.classList.contains("number__choose-delete")&&(I(),v[1].classList.add("active"),v[4].classList.remove("active"))}))}if(e.target.classList.contains("menu__btn")){let P=document.querySelector(".info__box"),Y=document.querySelector(".picture__box");_.style.display="flex",S.style.display="flex",S.addEventListener("click",(function(e){e.target.classList.contains("menu__close")&&(_.style.display="none",S.style.display="none"),e.target.classList.contains("manual")&&(n.style.display="none",P.style.display="flex",document.querySelector(".info__close").onclick=function(){P.style.display="none"}),e.target.classList.contains("pay")&&(q.style.display="flex",document.querySelector(".pay__close").onclick=function(){q.style.display="none"}),e.target.classList.contains("choose__picture")&&(Y.style.display="grid",document.querySelector(".picture__close").onclick=function(){Y.style.display="none"},Y.addEventListener("click",(function(e){if(e.target.classList.contains("picture__click")){let n=e.target.dataset.point,a=localStorage.getItem(`pictureData${n}`);Y.style.display="none",_.style.display="none",S.style.display="none",t.style.display="none",document.querySelector("#imgCurrent").src="",w.src="",s.clearRect(0,0,l.width,l.height),C.style.display="none",X.style.display="none",_.style.display="none",0===h?(w.src="data:image/gif;base64,"+a,A(),E.style.display="block",$.style.display="none"):(k.style.display="flex",k.innerText="",k.insertAdjacentHTML("afterbegin",`<img src="img/picture/pic${n}.jpg?rand${Math.random()}" alt="животное" />`)),M()}})))}))}}));let S,q,k=document.querySelector(".chekbox__track"),w=document.querySelector(".range__input"),E=document.querySelector(".range__value-box"),T=(w.step,w.max),$=w.min,A=w.value;!function(){S=(A-$)/(T-$)*100,k.style.background=`linear-gradient(to right, #98c1d9 0%, #98c1d9 ${S}%,  transparent ${S}%, transparent 100%)`,E.style.left=`${S}%`;let e=document.querySelector(".range__value"),t=document.querySelector(".range__number.begin"),n=document.querySelector(".range__number.end");e.innerText=w.value,t.innerText=$,n.innerText=T,q=w.value}(),w.addEventListener("input",(function(){let e,t=document.querySelector(".chekbox__track"),n=document.querySelector(".range__input"),a=document.querySelector(".range__value-box"),l=n.max,o=n.min;e=(n.value-o)/(l-o)*100,t.style.background=`linear-gradient(to right, #98c1d9 0%,  #98c1d9 ${e}%, transparent ${e}%, transparent 100%)`,a.style.left=`${e}%`,document.querySelector(".range__value").innerText=n.value,q=n.value;let s=document.querySelector(".range__number.end"),c=document.querySelector(".range__number.begin");return e<10&&(a.style.transform="translateX(3px)"),e>10&&(a.style.transform="translateX(2px)"),e>20&&(a.style.transform="translateX(-1px)"),e>30&&(a.style.transform="translateX(-3px)"),e>40&&(a.style.transform="translateX(-7px)"),e>50&&(a.style.transform="translateX(-7px)"),e>60&&(a.style.transform="translateX(-10px)"),e>80&&(a.style.transform="translateX(-15px)"),e>90&&(a.style.transform="translateX(-17px)"),c.style.visibility=e<5?"hidden":"visible",s.style.display=e>95?"none":"flex",q})),document.querySelector(".screenshot__btn").addEventListener("click",(function(){html2canvas(document.querySelector(".canvas")).then((e=>{e.toBlob((function(e){saveAs(e,"hangge.png")}))}))}));let I,X=document.querySelector(".pictire__left"),C=document.querySelector(".pictire__right");function M(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,t.width,t.height),I=t.toDataURL("image/gif"),I.replace(/^data:image\/(png|jpg|gif);base64,/,"")}X.addEventListener("click",(function(){let e=document.querySelectorAll("canvas");C.style.display="block",2===r?(X.style.display="none",r=1):r--,p(e[r])})),C.addEventListener("click",(function(){let e=document.querySelectorAll("canvas");X.style.display="block",r!==e.length-1&&(r++,p(e[r]))})),document.querySelector(".btn__phone").onclick=async function(e){let t=e.target.dataset.link,n=document.createElement("INPUT");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),alert("Номер телефона "+t+" скопирован")},window.addEventListener("load",(function(){let e=document.querySelectorAll(".number__pic-img"),t=new Array;for(let n=0;n<e.length;n++)t[n]=M(e[n]),localStorage.setItem(`imgData${n}`,t[n])})),window.addEventListener("load",(function(){let e=document.querySelectorAll(".picture__img"),t=new Array;for(let n=0;n<e.length;n++)t[n]=M(e[n]),localStorage.setItem(`pictureData${n}`,t[n])}))})();