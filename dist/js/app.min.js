(()=>{"use strict";const e=window.Telegram.WebApp;e.ready(),e.expand();let t=document.querySelector(".hi__wrapper"),n=localStorage.getItem("data");document.querySelector(".hi__close"),t.style.display=null===n?"block":"none",localStorage.setItem("data",1);const a=document.querySelector("canvas"),l=document.querySelector(".wrapper__touch"),o=a.getContext("2d");let s="#000000",c="#000000",i=1,r=null,d=null;function u(){a.width=window.innerWidth,a.height=window.innerHeight}function y(e){let t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}function m(e){let t=document.querySelector(".canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}function p(e,t,n=`${s}`){o.fillStyle=n,o.strokeStyle=n,o.beginPath(),o.arc(e,t,""+S/2,0,2*Math.PI),o.fill()}u(),l.append(y(a)),window.addEventListener("resize",u),document.querySelector(".color__box").addEventListener("change",(function(e){e.preventDefault();let t=document.querySelector(".color__choose");s=t.value,c=t.value})),l.addEventListener("touchstart",(function(e){if(e.target.classList.contains("canvas")||e.target.classList.contains("number__box")){if(i>=1){let e=document.querySelectorAll("canvas");for(let t=i+1;t<e.length;t++)e[t].remove()}!function(e){r={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY},d={x:r.x,y:r.y},p(r.x,r.y,`${s}`),o.beginPath(),o.moveTo(r.x,r.y)}(e)}})),l.addEventListener("touchmove",(function(e){(e.target.classList.contains("canvas")||e.target.classList.contains("number__box"))&&function(e){d={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY},o.lineTo(d.x,d.y),o.lineWidth=S,o.strokeStyle=s,o.lineCap="round",o.lineJoin="bevel",o.stroke()}(e)})),l.addEventListener("touchend",(function(e){(e.target.classList.contains("canvas")||e.target.classList.contains("number__box"))&&(function(e){i++,I.style.display=i>0?"block":"none",d={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}}(e),l.append(y(a)))}));let g={x:0,y:0},_=!1;a.addEventListener("mousedown",(function(e){0===e.button&&(g.x=e.pageX-this.offsetLeft,g.y=e.pageY-this.offsetTop,_=!0,p(g.x,g.y,`${s}`),o.beginPath(),o.moveTo(g.x,g.y))})),a.addEventListener("mousemove",(function(e){if(0===e.button&&1==_){if(i>=1){let e=document.querySelectorAll("canvas");for(let t=i+1;t<e.length;t++)e[t].remove()}g.x=e.pageX-this.offsetLeft,g.y=e.pageY-this.offsetTop,o.lineTo(g.x,g.y),o.lineWidth=S,o.strokeStyle=s,o.lineCap="round",o.lineJoin="bevel",o.stroke()}})),a.addEventListener("mouseup",(function(e){0===e.button&&(g.x=e.pageX-this.offsetLeft,g.y=e.pageY-this.offsetTop,o.lineTo(g.x,g.y),o.stroke(),o.closePath(),_=!1,l.append(y(a)),i++,I.style.display=i>0?"block":"none")}));let f,h=document.querySelectorAll(".tool__item"),v=document.querySelectorAll(".btn__audio"),b=0;function x(){f=navigator.onLine?1:0}window.addEventListener("online",x),window.addEventListener("offline",x),x(),l.addEventListener("click",(function(e){e.target.classList.contains("hi__wrapper")||e.target.classList.contains("hi__text")||e.target.classList.contains("hi__name")||(t.style.display="none");let n=document.querySelector(".number__box"),r=document.querySelector(".number__choose"),d=document.querySelector(".number__choose-close"),u=document.querySelector(".range__wrapper"),m=document.querySelector(".range__close"),p=document.querySelector(".btn__play"),g=parseInt(e.target.dataset.number),_=document.querySelector(".menu__wrapper"),L=document.querySelector(".reset__confirmation"),S=document.querySelector(".menu__box"),q=document.querySelector(".pay__box"),w=document.querySelector(".picture__wrapper"),k=document.getElementById("picCurrent"),E=document.querySelector(".pic__current"),T=document.getElementById("imgCurrent"),$=document.querySelector(".img__current");function A(){w.style.display="none",n.style.display="none"}function C(){n.style.display="none",r.style.display="none",p.classList.remove("active")}function M(){h[g].classList.remove("active"),h[1].classList.add("active")}if(e.target.classList.contains("btn__audio")&&(b=parseInt(e.target.dataset.sound),v.forEach((e=>e.classList.remove("active"))),v[b].classList.add("active")),e.target.classList.contains("tool__click")&&(h.forEach((e=>e.classList.remove("active"))),u.style.display="none",e.target.classList.add("active"),r.style.display="none",s=0===g?"#ffffff":c),e.target.classList.contains("width__box")&&(u.style.display="block",h[g].classList.add("active"),m.onclick=function(){u.style.display="none",M()}),e.target.classList.contains("reset__box")&&(_.style.display="flex",L.style.display="block",_.addEventListener("click",(function(e){if(e.target.classList.contains("yes")&&(o.clearRect(0,0,a.width,a.height),X.style.display="none",I.style.display="none",_.style.display="none",L.style.display="none",w.style.display="none",E.style.display="none",$.style.display="none",M(),C(),document.querySelector("#imgCurrent").src="",i>1)){let e=document.querySelectorAll("canvas");for(let t=1;t<e.length;t++)e[t].remove();l.append(y(a)),i=1}e.target.classList.contains("no")&&(_.style.display="none",L.style.display="none",M())}))),e.target.classList.contains("number__btn")){function D(e){var t=new Audio;t.src=e,t.autoplay=!0}r.style.display="grid",d.onclick=function(){r.style.display="none",M()},r.addEventListener("click",(function(e){let t=e.target.dataset.point;if(e.target.classList.contains("number__choose-item")){if(x(),o.clearRect(0,0,a.width,a.height),n.style.display="flex",n.innerText="",w.style.display="none",0===f){let e=localStorage.getItem(`imgData${t}`);$.style.display="block",E.style.display="none",A(),T.innerText="",T.src="data:image/gif;base64,"+e,p.classList.remove("active")}else{n.insertAdjacentHTML("afterbegin",`<img src="img/number/number${t}.gif?rand${Math.random()}" alt="number" />`),p.classList.add("active");let e=`./files/audio/audio${t}.mp3`;0===b&&D(e),p.onclick=function(){n.innerText="",n.insertAdjacentHTML("afterbegin",`<img src="img/number/number${t}.gif?rand${Math.random()}" alt="number" />`),0===b&&D(e)}}if(X.style.display="none",I.style.display="none",i>1){let e=document.querySelectorAll("canvas");for(let t=1;t<e.length;t++)e[t].remove();l.append(y(a)),i=1}r.style.display="none",M(),s=c}e.target.classList.contains("number__choose-delete")&&(C(),h[1].classList.add("active"),h[4].classList.remove("active"))}))}if(e.target.classList.contains("menu__btn")){let P=document.querySelector(".info__box"),Y=document.querySelector(".picture__box");_.style.display="flex",S.style.display="flex",S.addEventListener("click",(function(e){e.target.classList.contains("menu__close")&&(_.style.display="none",S.style.display="none"),e.target.classList.contains("manual")&&(t.style.display="none",P.style.display="flex",document.querySelector(".info__close").onclick=function(){P.style.display="none"}),e.target.classList.contains("pay")&&(q.style.display="flex",document.querySelector(".pay__close").onclick=function(){q.style.display="none"}),e.target.classList.contains("choose__picture")&&(Y.style.display="grid",document.querySelector(".picture__close").onclick=function(){Y.style.display="none"},Y.addEventListener("click",(function(e){if(e.target.classList.contains("picture__click")){let t=e.target.dataset.point,l=localStorage.getItem(`pictureData${t}`);Y.style.display="none",_.style.display="none",S.style.display="none",n.style.display="none",document.querySelector("#imgCurrent").src="",k.src="",o.clearRect(0,0,a.width,a.height),X.style.display="none",I.style.display="none",_.style.display="none",0===f?(k.src="data:image/gif;base64,"+l,A(),E.style.display="block",$.style.display="none"):(w.style.display="flex",w.innerText="",w.insertAdjacentHTML("afterbegin",`<img src="img/picture/pic${t}.jpg?rand${Math.random()}" alt="животное" />`)),M()}})))}))}}));let L,S,q=document.querySelector(".chekbox__track"),w=document.querySelector(".range__input"),k=document.querySelector(".range__value-box"),E=(w.step,w.max),T=w.min,$=w.value;!function(){L=($-T)/(E-T)*100,q.style.background=`linear-gradient(to right, #98c1d9 0%, #98c1d9 ${L}%,  transparent ${L}%, transparent 100%)`,k.style.left=`${L}%`;let e=document.querySelector(".range__value"),t=document.querySelector(".range__number.begin"),n=document.querySelector(".range__number.end");e.innerText=w.value,t.innerText=T,n.innerText=E,S=w.value}(),w.addEventListener("input",(function(){let e,t=document.querySelector(".chekbox__track"),n=document.querySelector(".range__input"),a=document.querySelector(".range__value-box"),l=n.max,o=n.min;e=(n.value-o)/(l-o)*100,t.style.background=`linear-gradient(to right, #98c1d9 0%,  #98c1d9 ${e}%, transparent ${e}%, transparent 100%)`,a.style.left=`${e}%`,document.querySelector(".range__value").innerText=n.value,S=n.value;let s=document.querySelector(".range__number.end"),c=document.querySelector(".range__number.begin");return e<10&&(a.style.transform="translateX(3px)"),e>10&&(a.style.transform="translateX(2px)"),e>20&&(a.style.transform="translateX(-1px)"),e>30&&(a.style.transform="translateX(-3px)"),e>40&&(a.style.transform="translateX(-7px)"),e>50&&(a.style.transform="translateX(-7px)"),e>60&&(a.style.transform="translateX(-10px)"),e>80&&(a.style.transform="translateX(-15px)"),e>90&&(a.style.transform="translateX(-17px)"),c.style.visibility=e<5?"hidden":"visible",s.style.display=e>95?"none":"flex",S})),document.querySelector(".screenshot__btn").addEventListener("click",(function(){html2canvas(document.querySelector(".canvas")).then((e=>{e.toBlob((function(e){saveAs(e,"hangge.png")}))}))}));let A,I=document.querySelector(".pictire__left"),X=document.querySelector(".pictire__right");function C(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,t.width,t.height),A=t.toDataURL("image/gif"),A.replace(/^data:image\/(png|jpg|gif);base64,/,"")}I.addEventListener("click",(function(){let e=document.querySelectorAll("canvas");X.style.display="block",2===i?(I.style.display="none",i=1):i--,m(e[i])})),X.addEventListener("click",(function(){let e=document.querySelectorAll("canvas");I.style.display="block",i!==e.length-1&&(i++,m(e[i]))})),document.querySelector(".btn__phone").onclick=async function(e){let t=e.target.dataset.link,n=document.createElement("INPUT");n.value=t,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),alert("Номер телефона "+t+" скопирован")},window.addEventListener("load",(function(){let e=document.querySelectorAll(".number__pic-img"),t=new Array;for(let n=0;n<e.length;n++)t[n]=C(e[n]),localStorage.setItem(`imgData${n}`,t[n])})),window.addEventListener("load",(function(){let e=document.querySelectorAll(".picture__img"),t=new Array;for(let n=0;n<e.length;n++)t[n]=C(e[n]),localStorage.setItem(`pictureData${n}`,t[n])}))})();